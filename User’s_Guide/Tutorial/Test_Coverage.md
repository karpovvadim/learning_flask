Test Coverage (Тестовое покрытие)

Написание модульных тестов для вашего приложения позволяет вам убедиться, что написанный вами код работает так, как вы ожидаете. Flask предоставляет тестовый клиент, который имитирует запросы к приложению и возвращает данные ответа.

Вы должны протестировать как можно больше своего кода. Код в функциях запускается только при вызове функции, а код в ветвях, таких как блоки if, запускается только при выполнении условия. Вы хотите убедиться, что каждая функция тестируется с данными, которые охватывают каждую ветвь.

Чем ближе вы подходите к 100% охвату, тем комфортнее вы можете быть уверены, что внесение изменений не приведет к неожиданному изменению другого поведения. Однако 100% охват не гарантирует отсутствие ошибок в вашем приложении. В частности, он не проверяет, как пользователь взаимодействует с приложением в браузере. Несмотря на это, тестовое покрытие является важным инструментом, который можно использовать во время разработки.

Примечание

Это будет представлено в конце учебника, но в ваших будущих проектах вы должны тестировать их по мере разработки.

Вы будете использовать pytest и покрытие для тестирования и измерения кода. Установите их оба:

$ pip установить покрытие pytest

Настройка и приспособления

Код теста находится в папке с тестами. Этот каталог находится рядом с пакетом flaskr, а не внутри него. Файл test/conftest.py содержит функции настройки, называемые фикстурами, которые будут использоваться каждым тестом. Тесты находятся в модулях Python, которые начинаются с test_, и каждая тестовая функция в этих модулях также начинается с test_.

Каждый тест будет создавать новый временный файл базы данных и заполнять некоторые данные, которые будут использоваться в тестах. Напишите файл SQL для вставки этих данных.