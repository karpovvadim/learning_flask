Templates (Шаблоны)

Вы написали представления аутентификации для своего приложения, но если вы запустите сервер и
попытаетесь перейти по любому из URL-адресов, вы увидите ошибку TemplateNotFound. Это потому,
что представления вызывают render_template(), но вы еще не написали шаблоны. Файлы шаблонов
будут храниться в каталоге templates внутри пакета flaskr.
Шаблоны — это файлы, содержащие статические данные, а также заполнители для динамических
данных. Шаблон визуализируется с определенными данными для создания окончательного документа.
Flask использует библиотеку шаблонов Jinja для рендеринга шаблонов.
В вашем приложении вы будете использовать шаблоны для рендеринга HTML, который будет
отображаться в браузере пользователя. Во Flask Jinja настроен на автоматическое экранирование
любых данных, отображаемых в шаблонах HTML. Это означает, что отображать пользовательский
ввод безопасно; любые введенные ими символы, которые могут испортить HTML, такие как < и >,
будут экранированы безопасными значениями, которые выглядят одинаково в браузере, но не
вызывают нежелательных эффектов.

Jinja выглядит и ведет себя в основном как Python. Специальные разделители используются для
того, чтобы отличить синтаксис Jinja от статических данных в шаблоне. Все, что находится
между {{ и }}, является выражением, которое будет выводиться в окончательный документ.
{% и %} обозначают оператор потока управления, такой как if и for. В отличие от Python, блоки
обозначаются начальным и конечным тегами, а не отступом, поскольку статический текст внутри
блока может изменить отступ.

The Base Layout (Базовый макет)

Каждая страница в приложении будет иметь один и тот же базовый макет вокруг другого тела.
Вместо того, чтобы писать всю структуру HTML в каждом шаблоне, каждый шаблон будет расширять
базовый шаблон и переопределять определенные разделы.
flaskr/templates/base.html

<!doctype html>
<title>{% block title %}{% endblock %} - Flaskr</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<nav>
  <h1>Flaskr</h1>
  <ul>
    {% if g.user %}
      <li><span>{{ g.user['username'] }}</span>
      <li><a href="{{ url_for('auth.logout') }}">Log Out</a>
    {% else %}
      <li><a href="{{ url_for('auth.register') }}">Register</a>
      <li><a href="{{ url_for('auth.login') }}">Log In</a>
    {% endif %}
  </ul>
</nav>
<section class="content">
  <header>
    {% block header %}{% endblock %}
  </header>
  {% for message in get_flashed_messages() %}
    <div class="flash">{{ message }}</div>
  {% endfor %}
  {% block content %}{% endblock %}
</section>

g автоматически доступен в шаблонах. В зависимости от того, установлен ли g.user 
(из load_logged_in_user), отображаются либо имя пользователя и ссылка для выхода, либо ссылки
для регистрации и входа. url_for() также доступен автоматически и используется для создания
URL-адресов для представлений вместо того, чтобы записывать их вручную.
После заголовка страницы и перед содержимым шаблон повторяет каждое сообщение, возвращаемое
функцией get_flashed_messages(). Вы использовали flash() в представлениях для отображения
сообщений об ошибках, и это код, который их отобразит.
Здесь определены три блока, которые будут переопределены в других шаблонах:
    1. {% block title %} изменит заголовок, отображаемый на вкладке браузера, и заголовок окна.
    2. {% block header %} аналогичен заголовку, но изменит заголовок, отображаемый на
странице.
    3. {% block content %} — это место, куда помещается содержимое каждой страницы, например
форма входа или сообщение в блоге.
Базовый шаблон находится непосредственно в каталоге шаблонов. Чтобы другие были организованы,
шаблоны для схемы будут помещены в каталог с тем же именем, что и схема.

Register (регистр)
flaskr/templates/auth/register.html
{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Register{% endblock %}</h1>
{% endblock %}

{% block content %}
  <form method="post">
    <label for="username">Username</label>
    <input name="username" id="username" required>
    <label for="password">Password</label>
    <input type="password" name="password" id="password" required>
    <input type="submit" value="Register">
  </form>
{% endblock %}

{% extends 'base.html' %} сообщает Jinja, что этот шаблон должен заменить блоки из базового
шаблона. Все отображаемое содержимое должно отображаться внутри тегов {% block %}, которые
переопределяют блоки из базового шаблона.
Полезный шаблон, используемый здесь, заключается в размещении {% заголовка блока %} внутри
{% заголовка блока %}. Это установит блок заголовка, а затем выведет его значение в блок
заголовка, так что и окно, и страница будут иметь один и тот же заголовок, не записывая его
дважды.
Входные теги используют здесь обязательный атрибут. Это говорит браузеру не отправлять форму,
пока эти поля не будут заполнены. Если пользователь использует более старый браузер, который
не поддерживает этот атрибут, или если он использует что-то помимо браузера для выполнения
запросов, вы все равно хотите проверить данные в представлении Flask. Важно всегда полностью
проверять данные на сервере, даже если клиент также выполняет некоторую проверку.

Log In (Авторизоваться)

Он идентичен шаблону регистрации, за исключением заголовка и кнопки отправки.
flaskr/templates/auth/login.html

{% extends 'base.html' %}
{% block header %}
  <h1>{% block title %}Log In{% endblock %}</h1>
{% endblock %}
{% block content %}
  <form method="post">
    <label for="username">Username</label>
    <input name="username" id="username" required>
    <label for="password">Password</label>
    <input type="password" name="password" id="password" required>
    <input type="submit" value="Log In">
  </form>
{% endblock %}

Register A User (Зарегистрировать пользователя)

Теперь, когда шаблоны аутентификации написаны, вы можете зарегистрировать пользователя.
Убедитесь, что сервер все еще работает (если нет, запустите flask), затем перейдите по
адресу http://127.0.0.1:5000/auth/register.
Попробуйте нажать кнопку «Регистрация», не заполняя форму, и увидите, что браузер показывает
сообщение об ошибке. Попробуйте удалить необходимые атрибуты из шаблона register.html и
снова нажмите «Зарегистрироваться». Вместо того чтобы браузер отображал ошибку, страница
перезагрузится, и в представлении будет показана ошибка из flash().
Заполните имя пользователя и пароль, и вы будете перенаправлены на страницу входа.
Попробуйте ввести неправильное имя пользователя или правильное имя пользователя и неверный
пароль. Если вы войдете в систему, вы получите сообщение об ошибке, потому что еще нет
представления индекса для перенаправления.

Continue to Static Files.